$schema: "https://json-schema.org/draft/2020-12/schema"
$id: "https://example.com/operating-data.schema.json"
title: "Operating Data"
description: "A product in the catalog"
type: "object"
required:
    - session_id
    - port_id
    - plug_start_datetime
    - plug_end_datetime
    - charge_start_datetime
    - charge_end_datetime
    - session_duration
    - charging_duration
    - energy_kwh
    - peak_kwh
    - total_fee_charged
    - energy_fee
    - session_fee
    - time_fee
    - user_id
    - successful_completion
    - ended_by
    - start_soc
    - end_soc
    - error_code
    - payment_type
properties:

    session_id:
        description: |
            Unique identifier for session record
        type: string  # default=yes	part 680=yes

    port_id:
        description: |
            Unique identifier for specified port. (For NEVI or other Part 680 project, 
            port_id must be same as the permanent station identifier provided
            to third parties pursuant to CFR 23 ยง 680.116(c)(8)(iii).)
        type: string  # default=yes	part 680=yes

    plug_start_datetime:
        description: |
            Date and time of session initialization (plug in)
        type: string
        format: date-time  # date/time default=yes	part 680=yes

    plug_end_datetime:
        description: |
            Date and time of session termination (plug out)
        type: string
        format: date-time  #  date/time default=yes	part 680=no

    charge_start_datetime:
        description: |
            Date and time when charging began
        type: string
        format: date-time  #  date/time default=yes	part 680=no

    charge_end_datetime:
        description: |
            Charging end date time
        type: string
        format: date-time  #  date/time default=no	part 680=no

    session_duration:
        description: |
            Total duration of session (plug in to plug out)
        type: string # duration duration default=no	part 680=no
        pattern: '^(-?)P(?=\d|T\d)(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)([DW]))?(?:T(?:(\d+)H)?(?:(\d+)M)?(?:(\d+(?:\.\d+)?)S)?)?$'

    charging_duration:
        description: |
            Total duration of time when electricity was actively dispensed - may not
            always be equal to the difference between charge_start_datetime
            and charge_end_datetime due to charge interruptions or managed charging
        type: string # duration; // duration default=no	part 680=no
        format: regex
        pattern: '^(-?)P(?=\d|T\d)(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)([DW]))?(?:T(?:(\d+)H)?(?:(\d+)M)?(?:(\d+(?:\.\d+)?)S)?)?$'

    energy_kwh:
        description: |
            Electricity dispensed (in kilowatt-hours) during charging session
        type: number  # non-negative float default=yes	part 680=yes
        minimum: 0

    peak_kw:
        description: |
            Session maximum power delivery (in kilowatts)
        type: number   # non-negative float default=yes	part 680=yes
        minimum: 0

    total_fee_charged:
        description: |
            The amount charged to the EV driver (in USD) where applicable - zero
            if driver was not charged for an otherwise paid charger, NULL if charger is not paid
        type: number #  cost float(2) default=yes	part 680=no

    energy_fee:
        description: |
            Fee (in USD) charged to user per kilowatt-hour
        type: number # cost float(2) default=yes	part 680=no

    session_fee:
        description: |
            Fee (in USD) charged to user per session
        type: number # cost float(2) default=no	part 680=no

    time_fee:
        description: |
            Fee (in USD) charged to users per minute
        type: number # cost float(2) default=no	part 680=no

    user_id:
        description: |
            Anonymized network-specific unique user ID
        type: string  # default=no	part 680=no

    successful_completion:
        description: |
            Whether or not the session ended as expected
        type: boolean  # default=no	part 680=no

    ended_by:
        description: |
            Cause of the session to end (e.g., unplugged while charging).
        type: string  # default=no	part 680=no

    start_soc:
        description: |
            Battery state of charge at session start represented as a decimal between 0 and 1
        type: number  # float(2) default=no	part 680=no
        minimum: 0
        maximum: 1

    end_soc:
        description: |
            Battery state of charge at session end represented as a decimal between 0 and 1
        type: number  # float(2) default=no	part 680=no
        minimum: 0
        maximum: 1

    error_code:
        description: |
            Session error code(s) if any. Separated by comma if multiple.
        type: string  # default=no	part 680=yes

    payment_type:
        description: |
            Valid Payment Type
        enum:
            - 'cash'
            - 'credit_card_terminal'
            - 'membership'
            - 'application'
            - 'phone'
            - 'plug-charge'
            - 'roaming'
            - 'other'
        # default=no	part 680=yes
